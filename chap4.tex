\chapter{基于规则的智能体}
\label{section:RuleBasedAIPlayers}

在炉石传说中，不同卡组的强度是不一致的，部分卡组会本质上强于其他卡组。
因此，本论文所有的智能体均会使用相同的卡组，卡组的组成如表格~\ref{table:TestDeck}~所示。
\begin{table}[!ht]
\small
\caption{测试智能体使用的猎人职业卡组}
\label{table:TestDeck}
\begin{tabular}{|l|l|c|c|c|l|c|}
\hline
名称       & 类型 & 消耗 & 攻击     & 生命     & 效果                                     & 数量 \\
\hline
猎人印记   & 法术 & 0    &          &          & 使一个随从的生命值变为1                  & 2    \\
\hline
奥术射击   & 法术 & 1    &          &          & 造成2点伤害                              & 2    \\
\hline
叫嚣的中士 & 随从 & 1    & 2        & 1        & \tabincell{l}{\textbf{战吼}：本回合中，\\使一个随从获得+2攻击力} & 2    \\
\hline
狼人渗透者 & 随从 & 1    & 2        & 1        & \textbf{潜行}                                   & 2    \\
\hline
爆炸陷阱   & 法术 & 2    &          &          & \tabincell{l}{\textbf{奥秘}：当你的英雄受到攻击时，\\对所有敌人造成2点伤害} & 2 \\
\hline
冰冻陷阱   & 法术 & 2    &          &          & \tabincell{l}{\textbf{奥秘}：当一个敌方随从进攻时，\\将其移回到所有者手中，\\并使其法力值消耗增加(2)} & 2 \\
\hline
鬼灵爬行者 & 随从 & 2    & 1        & 2        & \textbf{亡语}：召唤两个1/1的鬼灵蜘蛛 & 2 \\
\hline
鹰角弓     & 武器 & 3    & 3        & 2        & \tabincell{l}{每当有一张你的\textbf{奥秘}牌被揭示时，\\便获得+1耐久度} & 2 \\
\hline
杀戮命令   & 法术 & 3    &          &          & \tabincell{l}{造成3点伤害。如果你控制\\野兽，则改为造成5点伤害} & 2 \\
\hline
关门放狗   & 法术 & 3    &          &          & \tabincell{l}{战场上每有一个敌方随从，\\便召唤一个1/1并具有\textbf{冲锋}的猎犬} & 2 \\
\hline
蜘蛛坦克   & 随从 & 3    & 3        & 4        &                                 & 2 \\
\hline
冰风雪人   & 随从 & 4    & 4        & 5        &                                 & 2 \\
\hline
火车王里艾诺 & 随从 & 5 & 6 & 2 & \tabincell{l}{\textbf{冲锋}，\textbf{战吼}：为你的对手\\召唤两只1/1的雏龙} & 1 \\
\hline
石拳食人魔 & 随从 & 6 & 6 & 7 & & 2 \\
\hline
加兹瑞拉   & 随从 & 7 & 6 & 9 & \tabincell{l}{每当该随从受到伤害，\\便获得攻击力翻倍} & 1 \\
\hline
强袭坦克   & 随从 & 8 & 7 & 7 & \textbf{圣盾} & 2 \\
\hline
\end{tabular}
\end{table}
该卡组借鉴了以往出现过的许多胜率稳定的猎人卡组，其中包含的卡牌的法力消耗跨度较大，包括了从消耗小同时体量小的随从卡到消耗大且体量大的随从卡，以及一定的法术卡。
除了法术消耗的跨度，随从卡的效果包含了炉石传说中绝大部分的典型随从效果，其中包括战吼\footnote{战吼效果会在随从被召唤时触发。}、
亡语\footnote{亡语效果会在随从阵亡时触发。}、潜行\footnote{潜行随从无法作为敌方法术或随从直接攻击的目标。潜行随从在进行攻击后将不再潜行。}、
冲锋\footnote{随从被召唤后会进入疲劳状态，无法攻击，直至下一回合。拥有冲锋效果的随从在被召唤后不会进入疲劳状态，可以直接攻击。}以及圣盾\footnote{拥有圣盾的随从将免疫下一次受到的伤害，并失去圣盾。}；
法术卡则包含了指向性与非指向性法术，以及部分奥秘卡。
卡组中甚至还包括了名为“火车王里艾诺”和名为“加兹瑞拉”的传说卡牌。作为传说卡牌，“火车王里艾诺”和“加兹瑞拉”对于猎人卡组都是很有用处的卡牌，同时也拥有比其他卡牌更复杂的效果。
综上所述，这个卡组十分适合用于测试智能体对各种不同效果的卡牌的处理能力。

在给定的测试环境下，智能体需要进行的决策包括如下：
\begin{enumerate}
\item 决定使用哪张手牌；
\item 决定使用哪个随从或英雄进行攻击，以及攻击的目标；
\item 决定是否使用英雄能力，以及英雄能力的目标。
\end{enumerate}
除此之外，智能体还需要决定上述操作的先后次序。

英雄或随从的攻击决策是完全信息的：所有可进行攻击的角色和可被攻击的目标都是可见的，攻击后的效果也是确定的。大部分英雄能力使用后的效果也是确定的，但少部分职业的英雄能力本身也存在一定的随机性。手牌使用的决策则是不完全信息的：是否使用某一张手牌还需要考虑下一张可能抽到的牌，因为特定卡牌之间的配合可以在炉石传说之中打出更好的效果；除此之外，对方的手牌和牌堆的信息也是隐藏的，我方手牌的使用同样需要考虑这些信息。

除了一个完全随机的智能体，本文还使用了一个基于规则的智能体进行试验。该智能体会按照预先设定的启发规则进行上述的决策。
首先它会根据对方在场随从和英雄的攻击力计算出对方的场攻。如果对方的场攻数高于当前我方英雄剩余生命值，即我方形势已十分险峻，
那么便会首先决定是否要打出某些满足条件的手牌进行自保，如召唤一个嘲讽\footnote{当对方拥有一个被标记为“嘲讽”的随从时，
我方英雄和随从无法对对方其他随从或英雄进行直接攻击，直到对方所有的嘲讽随从阵亡。}随从。
而后，智能体会根据手牌的优先级打出优先级最高的手牌。对于绝大多数卡牌而言，法力消耗越高的卡牌拥有越高的优先级。
在完成手牌的决策后，智能体会根据规则来判断哪些敌方随从对己方威胁较大。威胁较大的随从包括攻击力或生命值过高的随从。
当存在威胁较大的敌方随从时，智能体将在我方可进行攻击的随从中选取最优的攻击者，以求能以最小的代价杀死该威胁较大的敌方随从\footnote{随从进行攻击时会受到敌方随从的反击。优先以生命值远小于敌方随从攻击力的随从进行攻击可以使得我方生命值较高的的随从得以保留，从而控制损失。}。
当不存在这样的敌方随从时，我方所有可攻击的随从和英雄都会直接攻击敌方英雄，以求通过激进地压低敌方生命值为对方增加压力，从而拉大优势、赢得对局。
最终，如仍有充足的法力剩余，智能体将使用英雄能力。

正如前文所述，炉石传说是很复杂的游戏，如此简单的规则智能体固然无法与人类玩家相提并论。实际上，鉴于炉石传说的受欢迎程度之大，
在进行排名比赛时往往可以在较低的排名中匹配到使用规则智能体进行自动游戏以获益的玩家，即所谓的“脚本”。在与这些脚本进行对战时，
我们的规则智能体往往表现不俗，并在多数情况下取胜。由此，尽管确实无法与人类玩家相提并论，本文使用的规则智能体已具有一定的决策强度。
